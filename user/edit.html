<html>
    <head></head>

    <body>
        <div id="demo">
            <input type="text" id="username" placeholder="username" />
            <input type="password" id="password" placeholder="password" />
            <input type="email" id="email" placeholder="email"/>
            <input type="text" id="date" disabled/>
            <button v-on:click="saveData" name="save">Aanpassen</button>
        </div>
    </body>
</html>

<script src="../includes/master/master.js"></script>
<script>
$(document).ready(function() {
      document.title += 'user edit';
});

if(document.cookie != "") {
        var parts = (document.cookie.split("user="))[1];
        var values = JSON.parse(parts);
        if(values){
            userid = values.user_id;
            
            var demo = new Vue({
            el: '#demo',
            data : {
                values : null
            },
            methods: {

                saveData: function () {
                    // Place them in variables for the form checks
                    var username = document.getElementById('username').value;
                    var password = document.getElementById('password').value;
                    var email    = document.getElementById('email').value;

                    if(username == "" || password == "" || email == ""){
                        console.log("Een veld is leeg.");
                    }
                    else {
                        // MD5 the password
                        password = md5(password);
                        // Place the data in an object to convert to a json string
                        var values = {
                            user_id : userid,
                            username : username,
                            password : password,
                            email : email
                        };

                        // Convert object to jsonstring
                        values = JSON.stringify(values);
                        // HTTP post request
                        var xhr = new XMLHttpRequest();
                        xhr.open('PUT', 'http://localhost:8080/users/'+userid+'/edit');
                        // Send our values
                        xhr.send(values);
                    }
                },

                getData: function () {
                    var xhr = new XMLHttpRequest()
                    var self = this
                    xhr.open('GET', 'http://localhost:8080/users/'+userid)
                    xhr.onload = function () {
                        // Get values to show
                        self.values = (JSON.parse(xhr.responseText))[0];
                        var date = new Date(self.values.date_of_birth);
                        var date = date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate();
                        // Place values in fields
                        document.getElementById('username').value = self.values.username;
                        document.getElementById('email').value = self.values.email;
                        document.getElementById('date').value = date;
                    }
                    xhr.send()
                }
            }
            })

            demo.getData();

        }
        else {
            window.location = '/';
        }
}
else {
    window.location = '/';
}

</script>
